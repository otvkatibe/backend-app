
> backend-app@1.0.0 test
> jest --runInBand

[33mwarn[39m: Request failed {"duration":"6ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"b9c26357-7b04-41c6-8a3a-8e8c33618dc8","status":404,"timestamp":"2026-01-12T17:59:16.556Z","url":"/users/register"}
[33mwarn[39m: Request failed {"duration":"1ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"f1ad96c8-e0d9-4cfa-a6e9-d0cf23539237","status":404,"timestamp":"2026-01-12T17:59:16.566Z","url":"/users/login"}
[31merror[39m: Unhandled Exception escaped to ErrorHandler {"error":"Token invalido","requestId":"636ba73c-f351-410b-b810-dca1fd965504","stack":"Error: Token invalido\n    at ensureAuthenticated (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\src\\middlewares\\ensureAuthenticated.ts:28:15)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:688:15\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:276:14)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:942:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:825:5","timestamp":"2026-01-12T17:59:16.573Z"}
[33mwarn[39m: Request failed {"duration":"6ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"636ba73c-f351-410b-b810-dca1fd965504","status":401,"timestamp":"2026-01-12T17:59:16.576Z","url":"/categories"}
[31merror[39m: Unhandled Exception escaped to ErrorHandler {"error":"Token invalido","requestId":"0ff287f4-a601-4707-8e87-e78d045a6c69","stack":"Error: Token invalido\n    at ensureAuthenticated (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\src\\middlewares\\ensureAuthenticated.ts:28:15)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:688:15\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:276:14)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:942:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:825:5","timestamp":"2026-01-12T17:59:16.585Z"}
[33mwarn[39m: Request failed {"duration":"3ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"0ff287f4-a601-4707-8e87-e78d045a6c69","status":401,"timestamp":"2026-01-12T17:59:16.586Z","url":"/budgets"}
[31merror[39m: Unhandled Exception escaped to ErrorHandler {"error":"Token invalido","requestId":"963bd5d0-9633-442c-92be-2791fc39ab12","stack":"Error: Token invalido\n    at ensureAuthenticated (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\src\\middlewares\\ensureAuthenticated.ts:28:15)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:688:15\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:276:14)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:942:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:825:5","timestamp":"2026-01-12T17:59:16.600Z"}
[33mwarn[39m: Request failed {"duration":"3ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"963bd5d0-9633-442c-92be-2791fc39ab12","status":401,"timestamp":"2026-01-12T17:59:16.602Z","url":"/budgets"}
[31merror[39m: Unhandled Exception escaped to ErrorHandler {"error":"Token invalido","requestId":"9ce68281-d845-4f55-bcc9-ce7f7a16eb3d","stack":"Error: Token invalido\n    at ensureAuthenticated (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\src\\middlewares\\ensureAuthenticated.ts:28:15)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:688:15\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:276:14)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:942:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:825:5","timestamp":"2026-01-12T17:59:16.609Z"}
[33mwarn[39m: Request failed {"duration":"2ms","ip":"::ffff:127.0.0.1","method":"GET","requestId":"9ce68281-d845-4f55-bcc9-ce7f7a16eb3d","status":401,"timestamp":"2026-01-12T17:59:16.610Z","url":"/budgets?month=10&year=2026"}
[31merror[39m: Unhandled Exception escaped to ErrorHandler {"error":"Token invalido","requestId":"edf6a4ee-37fb-4255-b32b-5e05e915f133","stack":"Error: Token invalido\n    at ensureAuthenticated (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\src\\middlewares\\ensureAuthenticated.ts:28:15)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:688:15\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:276:14)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:942:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:825:5","timestamp":"2026-01-12T17:59:16.616Z"}
[33mwarn[39m: Request failed {"duration":"2ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"edf6a4ee-37fb-4255-b32b-5e05e915f133","status":401,"timestamp":"2026-01-12T17:59:16.617Z","url":"/goals"}
[31merror[39m: Unhandled Exception escaped to ErrorHandler {"error":"Token invalido","requestId":"0220a844-287e-4742-835f-684dccce5e63","stack":"Error: Token invalido\n    at ensureAuthenticated (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\src\\middlewares\\ensureAuthenticated.ts:28:15)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:688:15\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:276:14)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:942:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:825:5","timestamp":"2026-01-12T17:59:16.623Z"}
[33mwarn[39m: Request failed {"duration":"2ms","ip":"::ffff:127.0.0.1","method":"PATCH","requestId":"0220a844-287e-4742-835f-684dccce5e63","status":401,"timestamp":"2026-01-12T17:59:16.624Z","url":"/goals/undefined/add"}
[31merror[39m: Unhandled Exception escaped to ErrorHandler {"error":"Token invalido","requestId":"e0906738-87d5-492d-ab04-f3aec14fd0e1","stack":"Error: Token invalido\n    at ensureAuthenticated (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\src\\middlewares\\ensureAuthenticated.ts:28:15)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:688:15\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:276:14)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:942:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:825:5","timestamp":"2026-01-12T17:59:16.631Z"}
[33mwarn[39m: Request failed {"duration":"3ms","ip":"::ffff:127.0.0.1","method":"GET","requestId":"e0906738-87d5-492d-ab04-f3aec14fd0e1","status":401,"timestamp":"2026-01-12T17:59:16.632Z","url":"/goals"}
FAIL tests/e2e/finance-phase2.test.ts
  Modulo Financeiro Fase 2 E2E
    Orcamentos
      √ó deve criar/atualizar um orcamento (11 ms)
      √ó deve atualizar o mesmo orcamento (upsert) (11 ms)
      √ó deve listar orcamentos com filtros (7 ms)
    Metas
      √ó deve criar uma nova meta (6 ms)
      √ó deve adicionar fundos a meta (6 ms)
      √ó deve listar metas (7 ms)

  ‚óè Modulo Financeiro Fase 2 E2E ‚Ä∫ Orcamentos ‚Ä∫ deve criar/atualizar um orcamento

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 401

    [0m [90m 57 |[39m                 })[33m;[39m
     [90m 58 |[39m
    [31m[1m>[22m[39m[90m 59 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoBe([35m200[39m)[33m;[39m
     [90m    |[39m                                [31m[1m^[22m[39m
     [90m 60 |[39m             expect(res[33m.[39mbody[33m.[39mamount)[33m.[39mtoBe([32m"1500"[39m)[33m;[39m [90m// Decimal comes as string often[39m
     [90m 61 |[39m             expect(res[33m.[39mbody[33m.[39mcategoryId)[33m.[39mtoBe(categoryId)[33m;[39m
     [90m 62 |[39m         })[33m;[39m[0m

      at Object.<anonymous> (tests/e2e/finance-phase2.test.ts:59:32)

  ‚óè Modulo Financeiro Fase 2 E2E ‚Ä∫ Orcamentos ‚Ä∫ deve atualizar o mesmo orcamento (upsert)

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 401

    [0m [90m 73 |[39m                 })[33m;[39m
     [90m 74 |[39m
    [31m[1m>[22m[39m[90m 75 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoBe([35m200[39m)[33m;[39m
     [90m    |[39m                                [31m[1m^[22m[39m
     [90m 76 |[39m             expect(res[33m.[39mbody[33m.[39mamount)[33m.[39mtoBe([32m"2000"[39m)[33m;[39m [90m// Should be updated[39m
     [90m 77 |[39m         })[33m;[39m
     [90m 78 |[39m[0m

      at Object.<anonymous> (tests/e2e/finance-phase2.test.ts:75:32)

  ‚óè Modulo Financeiro Fase 2 E2E ‚Ä∫ Orcamentos ‚Ä∫ deve listar orcamentos com filtros

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 401

    [0m [90m 83 |[39m                 [33m.[39mquery({ month[33m:[39m [35m10[39m[33m,[39m year[33m:[39m [35m2026[39m })[33m;[39m
     [90m 84 |[39m
    [31m[1m>[22m[39m[90m 85 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoBe([35m200[39m)[33m;[39m
     [90m    |[39m                                [31m[1m^[22m[39m
     [90m 86 |[39m             expect(res[33m.[39mbody[33m.[39mdata)[33m.[39mtoHaveLength([35m1[39m)[33m;[39m
     [90m 87 |[39m             expect(res[33m.[39mbody[33m.[39mdata[[35m0[39m][33m.[39mamount)[33m.[39mtoBe([32m"2000"[39m)[33m;[39m
     [90m 88 |[39m         })[33m;[39m[0m

      at Object.<anonymous> (tests/e2e/finance-phase2.test.ts:85:32)

  ‚óè Modulo Financeiro Fase 2 E2E ‚Ä∫ Metas ‚Ä∫ deve criar uma nova meta

    expect(received).toBe(expected) // Object.is equality

    Expected: 201
    Received: 401

    [0m [90m 100 |[39m                 })[33m;[39m
     [90m 101 |[39m
    [31m[1m>[22m[39m[90m 102 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoBe([35m201[39m)[33m;[39m
     [90m     |[39m                                [31m[1m^[22m[39m
     [90m 103 |[39m             expect(res[33m.[39mbody[33m.[39mcurrentAmount)[33m.[39mtoBe([32m"0"[39m)[33m;[39m
     [90m 104 |[39m             goalId [33m=[39m res[33m.[39mbody[33m.[39mid[33m;[39m
     [90m 105 |[39m         })[33m;[39m[0m

      at Object.<anonymous> (tests/e2e/finance-phase2.test.ts:102:32)

  ‚óè Modulo Financeiro Fase 2 E2E ‚Ä∫ Metas ‚Ä∫ deve adicionar fundos a meta

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 401

    [0m [90m 111 |[39m                 [33m.[39msend({ amount[33m:[39m [35m500.00[39m })[33m;[39m
     [90m 112 |[39m
    [31m[1m>[22m[39m[90m 113 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoBe([35m200[39m)[33m;[39m
     [90m     |[39m                                [31m[1m^[22m[39m
     [90m 114 |[39m             expect(res[33m.[39mbody[33m.[39mcurrentAmount)[33m.[39mtoBe([32m"500"[39m)[33m;[39m
     [90m 115 |[39m         })[33m;[39m
     [90m 116 |[39m[0m

      at Object.<anonymous> (tests/e2e/finance-phase2.test.ts:113:32)

  ‚óè Modulo Financeiro Fase 2 E2E ‚Ä∫ Metas ‚Ä∫ deve listar metas

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 401

    [0m [90m 120 |[39m                 [33m.[39m[36mset[39m([32m'Authorization'[39m[33m,[39m [32m`Bearer ${token}`[39m)[33m;[39m
     [90m 121 |[39m
    [31m[1m>[22m[39m[90m 122 |[39m             expect(res[33m.[39mstatus)[33m.[39mtoBe([35m200[39m)[33m;[39m
     [90m     |[39m                                [31m[1m^[22m[39m
     [90m 123 |[39m             expect([33mArray[39m[33m.[39misArray(res[33m.[39mbody))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 124 |[39m             [36mconst[39m myGoal [33m=[39m res[33m.[39mbody[33m.[39mfind((g[33m:[39m any) [33m=>[39m g[33m.[39mid [33m===[39m goalId)[33m;[39m
     [90m 125 |[39m             expect(myGoal)[33m.[39mtoBeDefined()[33m;[39m[0m

      at Object.<anonymous> (tests/e2e/finance-phase2.test.ts:122:32)

[32minfo[39m: Request completed {"duration":"333ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"def58a32-36f2-4170-941e-51e883866c0c","status":201,"timestamp":"2026-01-12T17:59:18.247Z","url":"/users"}
[32minfo[39m: Request completed {"duration":"325ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"3c9aa6c7-b0d4-47bd-8f7e-78747f974cdf","status":201,"timestamp":"2026-01-12T17:59:18.708Z","url":"/users"}
[32minfo[39m: Request completed {"duration":"200ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"74503b12-0a9f-4408-886d-3bcfc15fb4fc","status":200,"timestamp":"2026-01-12T17:59:18.911Z","url":"/login"}
[32minfo[39m: Request completed {"duration":"211ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"b073b31b-2cb0-4fe7-8f6e-9adf4a4bb8a4","status":200,"timestamp":"2026-01-12T17:59:19.127Z","url":"/login"}
  console.log
    Authorize Middleware - User: { id: '1a80ffa5-088f-4cca-b479-52e47370091b', role: 'ADMIN' }

      at src/middlewares/authorize.ts:6:17

  console.log
    Authorize Middleware - Allowed: [ 'ADMIN' ]

      at src/middlewares/authorize.ts:7:17

[32minfo[39m: Request completed {"duration":"593ms","ip":"::ffff:127.0.0.1","method":"GET","requestId":"e26a84d7-0bb7-43f2-b908-602a89b646fd","status":200,"timestamp":"2026-01-12T17:59:19.726Z","url":"/users"}
  console.log
    Authorize Middleware - User: { id: 'ed575580-c7e1-4e83-ab18-67be2c495639', role: 'USER' }

      at src/middlewares/authorize.ts:6:17

  console.log
    Authorize Middleware - Allowed: [ 'ADMIN' ]

      at src/middlewares/authorize.ts:7:17

[31merror[39m: Unhandled Exception escaped to ErrorHandler {"error":"Access denied: Insufficient permissions","requestId":"9acdfd3d-2e2f-4d09-a599-6d24de9855c9","stack":"Error: Access denied: Insufficient permissions\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\src\\middlewares\\authorize.ts:14:19\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\route.js:157:13)\n    at ensureAuthenticated (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\src\\middlewares\\ensureAuthenticated.ts:26:16)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:295:15\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:942:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:825:5","timestamp":"2026-01-12T17:59:19.739Z"}
[33mwarn[39m: Request failed {"duration":"8ms","ip":"::ffff:127.0.0.1","method":"GET","requestId":"9acdfd3d-2e2f-4d09-a599-6d24de9855c9","status":403,"timestamp":"2026-01-12T17:59:19.740Z","url":"/users"}
[31merror[39m: Unhandled Exception escaped to ErrorHandler {"error":"Token ausente","requestId":"cd93da34-18b6-4a93-bf45-22b48d69dbe1","stack":"Error: Token ausente\n    at ensureAuthenticated (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\src\\middlewares\\ensureAuthenticated.ts:13:15)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\route.js:157:13)\n    at Route.dispatch (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\route.js:117:3)\n    at handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:435:11)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:295:15\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at Function.handle (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:186:3)\n    at router (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:60:12)\n    at Layer.handleRequest (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\lib\\layer.js:152:17)\n    at trimPrefix (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:342:13)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:297:9\n    at processParams (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:582:12)\n    at next (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\router\\index.js:291:5)\n    at C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:942:7\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\node_modules\\express-rate-limit\\dist\\index.cjs:825:5","timestamp":"2026-01-12T17:59:19.746Z"}
[33mwarn[39m: Request failed {"duration":"2ms","ip":"::ffff:127.0.0.1","method":"GET","requestId":"cd93da34-18b6-4a93-bf45-22b48d69dbe1","status":401,"timestamp":"2026-01-12T17:59:19.747Z","url":"/users"}
PASS tests/e2e/rbac.test.ts
  E2E RBAC
    GET /users (Admin Route)
      ‚àö should allow access to ADMIN (600 ms)
      ‚àö should deny access to regular USER (13 ms)
      ‚àö should deny access without token (6 ms)

[32minfo[39m: Request completed {"duration":"330ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"7421239d-74d0-4f11-ae6f-b425a5db5492","status":201,"timestamp":"2026-01-12T17:59:21.627Z","url":"/users"}
[32minfo[39m: Request completed {"duration":"205ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"c00be019-b8fc-4079-9f4c-d96071284b45","status":200,"timestamp":"2026-01-12T17:59:21.970Z","url":"/login"}
  console.log
    Authorize Middleware - User: { id: '3224267d-6095-4f21-8a10-534458713ea4', role: 'ADMIN' }

      at src/middlewares/authorize.ts:6:17

  console.log
    Authorize Middleware - Allowed: [ 'ADMIN' ]

      at src/middlewares/authorize.ts:7:17

[32minfo[39m: Request completed {"duration":"530ms","ip":"::ffff:127.0.0.1","method":"GET","requestId":"aee212ef-9648-429a-9ef7-c4fc4e516990","status":200,"timestamp":"2026-01-12T17:59:22.905Z","url":"/users"}
  console.log
    Authorize Middleware - User: { id: '3224267d-6095-4f21-8a10-534458713ea4', role: 'ADMIN' }

      at src/middlewares/authorize.ts:6:17

  console.log
    Authorize Middleware - Allowed: [ 'ADMIN' ]

      at src/middlewares/authorize.ts:7:17

[32minfo[39m: Request completed {"duration":"520ms","ip":"::ffff:127.0.0.1","method":"GET","requestId":"22a15aa2-6155-4488-adc5-c5d6bb172ab7","status":200,"timestamp":"2026-01-12T17:59:23.430Z","url":"/users?limit=5"}
  console.log
    Authorize Middleware - User: { id: '3224267d-6095-4f21-8a10-534458713ea4', role: 'ADMIN' }

      at src/middlewares/authorize.ts:6:17

  console.log
    Authorize Middleware - Allowed: [ 'ADMIN' ]

      at src/middlewares/authorize.ts:7:17

[32minfo[39m: Request completed {"duration":"560ms","ip":"::ffff:127.0.0.1","method":"GET","requestId":"425d29fc-b95d-4636-9973-6b20b271335c","status":200,"timestamp":"2026-01-12T17:59:23.995Z","url":"/users?page=2&limit=5"}
  console.log
    Authorize Middleware - User: { id: '3224267d-6095-4f21-8a10-534458713ea4', role: 'ADMIN' }

      at src/middlewares/authorize.ts:6:17

  console.log
    Authorize Middleware - Allowed: [ 'ADMIN' ]

      at src/middlewares/authorize.ts:7:17

[32minfo[39m: Request completed {"duration":"533ms","ip":"::ffff:127.0.0.1","method":"GET","requestId":"ac79b8a8-3bcb-44fb-b54f-09fe84d18357","status":200,"timestamp":"2026-01-12T17:59:24.533Z","url":"/users"}
PASS tests/e2e/pagination.test.ts
  E2E Pagination
    ‚àö should return 10 items by default (535 ms)
    ‚àö should return 5 items when limit is 5 (524 ms)
    ‚àö should return the second page of items (564 ms)
    ‚àö should return correct total metadata (538 ms)

[32minfo[39m: Request completed {"duration":"343ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"7181931d-c2bf-4fc8-a0b7-d8e9d7926755","status":201,"timestamp":"2026-01-12T17:59:26.477Z","url":"/users"}
[32minfo[39m: Request completed {"duration":"196ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"c7522c93-9133-41c2-9352-9b841fdd251a","status":200,"timestamp":"2026-01-12T17:59:26.680Z","url":"/login"}
[31merror[39m: Unhandled Exception escaped to ErrorHandler {"error":"Email ou senha invalidos","requestId":"40fb18ae-778a-46d3-9829-64abbe3ff329","stack":"Error: Email ou senha invalidos\n    at UserService.authenticate (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\src\\services\\user.service.ts:59:19)\n    at async login (C:\\Users\\otavi\\OneDrive\\√Årea de Trabalho\\Faculdade\\meu-projeto\\projetos-typescript\\backend-app\\src\\controllers\\user.controller.ts:22:28)","timestamp":"2026-01-12T17:59:26.891Z"}
[33mwarn[39m: Request failed {"duration":"207ms","ip":"::ffff:127.0.0.1","method":"POST","requestId":"40fb18ae-778a-46d3-9829-64abbe3ff329","status":401,"timestamp":"2026-01-12T17:59:26.892Z","url":"/login"}
PASS tests/e2e/auth.test.ts
  E2E Auth
    ‚àö should register a new user (354 ms)
    ‚àö should authenticate the user (200 ms)
    ‚àö should fail login with wrong password (212 ms)

[32minfo[39m: Request completed {"duration":"968ms","ip":"::ffff:127.0.0.1","method":"GET","requestId":"27126acd-9c46-42fc-86e9-73a75eceaeff","status":200,"timestamp":"2026-01-12T17:59:28.523Z","url":"/health"}
PASS tests/e2e/health.test.ts
  E2E Health Check
    ‚àö should return 200 UP (976 ms)

Test Suites: 1 failed, 4 passed, 5 total
Tests:       6 failed, 11 passed, 17 total
Snapshots:   0 total
Time:        15.154 s, estimated 16 s
Ran all test suites.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
